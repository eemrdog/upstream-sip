apiVersion: v1
kind: ServiceAccount
metadata:
  name: {{ include "eric-log-shipper.name" . | quote }}
  labels:
    {{- $serviceAccLabels := dict -}}
    {{- $_ := set $serviceAccLabels "app" (include "eric-log-shipper.name" .) -}}
    {{- $_ := set $serviceAccLabels "chart" (include "eric-log-shipper.chart" .) -}}
    {{- $_ := set $serviceAccLabels "component" .Values.logshipper.name -}}
    {{- $_ := set $serviceAccLabels "heritage" .Release.Service -}}
    {{- $_ := set $serviceAccLabels "release" .Release.Name -}}

    {{- $baseLabels := include "eric-log-shipper.labels" . | fromYaml -}}
    {{- include "eric-log-shipper.mergeLabels" (dict "location" .Template.Name "sources" (list $serviceAccLabels $baseLabels)) | trim | nindent 4 }}
  annotations:
    {{- include "eric-log-shipper.annotations" . | nindent 4 }}
{{- if not .Values.rbac.automountServiceAccountToken }}
automountServiceAccountToken: false
{{- end }}
