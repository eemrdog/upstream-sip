{{- $g := fromJson (include "eric-pm-bulk-reporter.global" .) -}}
## This file contains configuration information
## for the LDAP user management and LDAP libraries.

## LDAPT
##
## Defines LDAP host and access certificate and network timeout.
## The example certificate filepaths are adjusted for the AUM design environment.
##
## ldaptHost          defines LDAP service address, mandatory
## tlsCert            defines LDAP client certificate, mandatory
## tlsKey             defines LDAP client key, mandatory
## tlsCaCert          defines trusted root certificate, mandatory
## networkTimeout     defines LDAP operations timeout in seconds, optional
##
{{- if and .Values.security.tls.ldapServer.enabled $g.security.tls.enabled }}
[LDAPT]
ldaptHost = {{ .Values.userConfig.ldap.uri }}
tlsCert   = /run/secrets/ldap-client-cert/clicert.pem
tlsKey    = /run/secrets/ldap-client-cert/cliprivkey.pem
tlsCaCert = /run/secrets/cacert/cacertbundle.pem
networkTimeout = 3

{{- else }}
[LDAP]
ldapHost        = {{ .Values.userConfig.ldap.uri }}
managerDn       = cn=eric-aa-client,dc=la,dc=adp,dc=ericsson
managerPassword = @@AA_CLIENT_PASSWORD@@
networkTimeout  = 5

{{- end }}
## USER_MANAGEMEMT
##
## Defines the storage of the users and their last login time entries.
## Also an optional filepath location to output the previous last login time in
## the LDAP database, before updating the last login time value in the LDAP
## database to the current time.
##
## userDnPrefix                   defines user dn prefix, mandatory
## userDnLaPostfix                defines user dn postfix in local LDAP, mandatory
## userDnCaPostfix                defines user dn postfix in remote LDAP, mandatory
## loginTimeDnPrefix              defines last login time entry prefix, mandatory
## loginTimeDnPostfix             defines last login time entry postfix, mandatory
## previousLastLoginTimeFilepath  defines the filepath to print previous last login time, optional
##
[USER_MANAGEMENT]
userDnPrefix = uid
userDnLaPostfix = {{ .Values.userConfig.ldap.searchBase }}
userDnCaPostfix = ou=people,dc=ca,dc=adp,dc=ericsson
loginTimeDnPrefix = uid
loginTimeDnPostfix = ou=peopleextraattrs,dc=la,dc=adp,dc=ericsson
previousLastLoginTimeFilepath = /etc/motd
previousLastLoginTimePrefix = Last login time:
