{{- if and (not .Values.egress.ldap.certificates.trustedCertificateListSecret) .Values.egress.ldap.certificates.trustedCertificateListName -}}
apiVersion: com.ericsson.sec.certm/v1alpha2
kind: ExternalCertificate
metadata:
  name: {{ template "eric-sec-access-mgmt.name" . }}-egress-ldap-cacertificate
  annotations: {{- include "eric-sec-access-mgmt.common-annotations" . | nindent 4 }}
  labels: {{- include "eric-sec-access-mgmt.labels" . | nindent 4 }}

spec:
  generated-secret-name: {{ template "eric-sec-access-mgmt.name" . }}-egress-ldap-ca-cert
  generated-secret-type: opaque
  trusted-certificates-file-name: "cacertbundle.pem"
  trusted-certificate-list-name: {{ .Values.egress.ldap.certificates.trustedCertificateListName | quote }}
{{- end -}}
